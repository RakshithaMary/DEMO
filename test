// CLIENT LEVEL
MATCH (agg:AggTx)-[:FOR_CLIENT]->(c:Client)
RETURN 
  c.clientId AS levelKey,
  'Client' AS level,
  sum(agg.totalAmount) AS totalAmount,
  sum(agg.txCount) AS txCount

UNION ALL
// DEPOSIT PRODUCT LEVEL
MATCH (agg:AggTx)-[:FOR_CLIENT]->(c:Client)
MATCH (agg)-[:FOR_DEPOSIT_PRODUCT]->(dp:DepositProduct)
RETURN 
  c.clientId + '|' + dp.name AS levelKey,
  'DepositProduct' AS level,
  sum(agg.totalAmount) AS totalAmount,
  sum(agg.txCount) AS txCount

UNION ALL
// FLOW LEVEL
MATCH (agg:AggTx)-[:FOR_CLIENT]->(c:Client)
MATCH (agg)-[:FOR_DEPOSIT_PRODUCT]->(dp:DepositProduct)
MATCH (agg)-[:FOR_FLOW]->(f:Flow)
RETURN 
  c.clientId + '|' + dp.name + '|' + f.direction AS levelKey,
  'Flow' AS level,
  sum(agg.totalAmount) AS totalAmount,
  sum(agg.txCount) AS txCount

UNION ALL
// CHANNEL LEVEL
MATCH (agg:AggTx)-[:FOR_CLIENT]->(c:Client)
MATCH (agg)-[:FOR_DEPOSIT_PRODUCT]->(dp:DepositProduct)
MATCH (agg)-[:FOR_FLOW]->(f:Flow)
MATCH (agg)-[:FOR_CHANNEL]->(ch:Channel)
RETURN 
  c.clientId + '|' + dp.name + '|' + f.direction + '|' + ch.name AS levelKey,
  'Channel' AS level,
  sum(agg.totalAmount) AS totalAmount,
  sum(agg.txCount) AS txCount

UNION ALL
// PAYMENT PRODUCT LEVEL
MATCH (agg:AggTx)-[:FOR_CLIENT]->(c:Client)
MATCH (agg)-[:FOR_DEPOSIT_PRODUCT]->(dp:DepositProduct)
MATCH (agg)-[:FOR_FLOW]->(f:Flow)
MATCH (agg)-[:FOR_CHANNEL]->(ch:Channel)
MATCH (agg)-[:FOR_PAYMENT_PRODUCT]->(pp:PaymentProduct)
RETURN 
  c.clientId + '|' + dp.name + '|' + f.direction + '|' + ch.name + '|' + pp.name AS levelKey,
  'PaymentProduct' AS level,
  sum(agg.totalAmount) AS totalAmount,
  sum(agg.txCount) AS txCount

UNION ALL
// FINANCIAL INSTITUTION LEVEL
MATCH (agg:AggTx)-[:FOR_CLIENT]->(c:Client)
MATCH (agg)-[:FOR_DEPOSIT_PRODUCT]->(dp:DepositProduct)
MATCH (agg)-[:FOR_FLOW]->(f:Flow)
MATCH (agg)-[:FOR_CHANNEL]->(ch:Channel)
MATCH (agg)-[:FOR_PAYMENT_PRODUCT]->(pp:PaymentProduct)
MATCH (agg)-[:FOR_FI]->(fi:FinancialInstitution)
RETURN 
  c.clientId + '|' + dp.name + '|' + f.direction + '|' + ch.name + '|' + pp.name + '|' + fi.name AS levelKey,
  'FinancialInstitution' AS level,
  sum(agg.totalAmount) AS totalAmount,
  sum(agg.txCount) AS txCount

UNION ALL
// PROSPECT LEVEL
MATCH (agg:AggTx)-[:FOR_CLIENT]->(c:Client)
MATCH (agg)-[:FOR_DEPOSIT_PRODUCT]->(dp:DepositProduct)
MATCH (agg)-[:FOR_FLOW]->(f:Flow)
MATCH (agg)-[:FOR_CHANNEL]->(ch:Channel)
MATCH (agg)-[:FOR_PAYMENT_PRODUCT]->(pp:PaymentProduct)
MATCH (agg)-[:FOR_FI]->(fi:FinancialInstitution)
MATCH (agg)-[:FOR_PROSPECT]->(p:Prospect)
RETURN 
  c.clientId + '|' + dp.name + '|' + f.direction + '|' + ch.name + '|' + pp.name + '|' + fi.name + '|' + p.name AS levelKey,
  'Prospect' AS level,
  sum(agg.totalAmount) AS totalAmount,
  sum(agg.txCount) AS txCount;
