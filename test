// Non-BMO Parties who are part of Wire transactions
MATCH (p:Party)-[:IS_CUSTOMER_OF]->(fi:Financial_Institution)
MATCH (p)-[:IS_PAYOR_OF|IS_PAYEE_OF]->(t:Transaction)-[:IS_A]->(pp:Payment_Product)
WHERE toLower(pp.name) = "wire"
  AND NOT toLower(fi.fi_name_std) CONTAINS "bmo"
MERGE (pr:Prospect {party_id: p.party_id})
SET   pr += properties(p);

// BMO Parties who are part of Wire transactions
MATCH (p:Party)-[:IS_CUSTOMER_OF]->(fi:Financial_Institution)
MATCH (p)-[:IS_PAYOR_OF|IS_PAYEE_OF]->(t:Transaction)-[:IS_A]->(pp:Payment_Product)
WHERE toLower(pp.name) = "wire"
  AND toLower(fi.fi_name_std) CONTAINS "bmo"
MERGE (c:BMO_Client {party_id: p.party_id})
SET   c += properties(p);

