MATCH (b:BMO_Client)-[:HAS_COMPETITOR]->(fi:Competitor)-[:OFFERS]->(pp:Payment_Product)
MATCH (b)-[:IS_PAYOR_OF]->(t:Transaction)-[:IS_A]->(pp)
MATCH (pr:Prospect)-[:IS_PAYEE_OF]->(t)-[:IS_CUSTOMER_OF]->(fi)
WITH b, fi, pp, pr, count(t) AS txn_volume, sum(t.pmt_converted_amt_in_usd) AS txn_amount
MERGE (pp)-[r:OUTGOING]->(pr)
SET r.txn_volume   = txn_volume,
    r.txn_amount   = txn_amount,
    r.bmo_client   = b.party_name,
    r.competitor   = fi.fi_name_std;

MATCH (b:BMO_Client)-[:HAS_COMPETITOR]->(fi:Competitor)-[:OFFERS]->(pp:Payment_Product)
MATCH (pr:Prospect)-[:IS_PAYOR_OF]->(t:Transaction)-[:IS_A]->(pp)
MATCH (b)-[:IS_PAYEE_OF]->(t)-[:IS_CUSTOMER_OF]->(fi)
WITH b, fi, pp, pr, count(t) AS txn_volume, sum(t.pmt_converted_amt_in_usd) AS txn_amount
MERGE (pr)-[r:INCOMING]->(pp)
SET r.txn_volume   = txn_volume,
    r.txn_amount   = txn_amount,
    r.bmo_client   = b.party_name,
    r.competitor   = fi.fi_name_std;

