// Create / update OUTGOING relationships between Party -> Party
MATCH (payer:Party)-[:IS_PAYOR_OF]->(t:Transaction)<-[:IS_PAYEE_OF]-(payee:Party)
WITH payer, payee,
     count(t) AS outgoing_volume,
     sum(coalesce(t.amount,
                  t.wire_total_value,
                  t.pre_authorized_eft_deft_total_value, 0)) AS outgoing_amount
MERGE (payer)-[r:OUTGOING]->(payee)
SET  r.volume        = outgoing_volume,   // number of transactions
     r.amount        = outgoing_amount,   // total value of transactions
     r.last_computed = datetime()
REMOVE r.txn_count, r.total_value, r.total_volume, r.txn_ids, r.first_txn, r.last_txn;
